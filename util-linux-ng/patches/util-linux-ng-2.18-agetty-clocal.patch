From e143d1f00497f0178a1febec8fb4aa7c842fa35a Mon Sep 17 00:00:00 2001
From: Karel Zak <kzak@redhat.com>
Date: Mon, 12 Jul 2010 11:57:55 +0200
Subject: [PATCH] aggety: don't wipe CLOCAL flag

gettey should not clear the flag. It seems that the flag is
automatically enabled for serial consoles tht don't use CD signal.

Addresses: http://bugzilla.redhat.com/show_bug.cgi?id=598631
Signed-off-by: Karel Zak <kzak@redhat.com>
---
 login-utils/agetty.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/login-utils/agetty.c b/login-utils/agetty.c
index 9fc389b..2541948 100644
--- a/login-utils/agetty.c
+++ b/login-utils/agetty.c
@@ -709,7 +709,7 @@ termio_init(tp, op)
     /* flush input and output queues, important for modems! */
     (void) tcflush(0, TCIOFLUSH);
 
-    tp->c_cflag = CS8 | HUPCL | CREAD;
+    tp->c_cflag = CS8 | HUPCL | CREAD | (tp->c_cflag & CLOCAL);
 
     if (!(op->flags & F_KEEPSPEED)) {
 	    cfsetispeed(tp, op->speeds[FIRST_SPEED]);
-- 
1.7.2

