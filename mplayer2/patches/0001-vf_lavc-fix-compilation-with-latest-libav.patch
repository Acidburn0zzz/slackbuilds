From 5a053b2cae6bb0683c57a0c8cf03660d609e584c Mon Sep 17 00:00:00 2001
From: Anton Khirnov <anton@khirnov.net>
Date: Wed, 19 Sep 2012 14:00:01 +0200
Subject: [PATCH 1/9] vf_lavc: fix compilation with latest libav

Remove a pointless and broken check for avctx->codec->encode.

1) The check does not test for anything useful.
2) AVCodecContext.encode is a private field and is not supposed to be
   accessed from outside of lavc.
2a) AVCodecContext.encode does not exist anymore in latest libavcodec,
    so this block fails to build.
---
 libmpcodecs/vf_lavc.c | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/libmpcodecs/vf_lavc.c b/libmpcodecs/vf_lavc.c
index b2c1dd7..65e93a1 100644
--- a/libmpcodecs/vf_lavc.c
+++ b/libmpcodecs/vf_lavc.c
@@ -76,11 +76,6 @@ static int config(struct vf_instance *vf,
 	return 0;
     }
 
-    if (lavc_venc_context.codec->encode == NULL) {
-	mp_msg(MSGT_VFILTER,MSGL_ERR,"avcodec init failed (ctx->codec->encode == NULL)!\n");
-	return 0;
-    }
-
     return vf_next_config(vf,width,height,d_width,d_height,flags,IMGFMT_MPEGPES);
 }
 
-- 
1.7.12.3

