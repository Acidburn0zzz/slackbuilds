Index: kdepimlibs/kcal/recurrencerule.cpp
===================================================================
--- kdepimlibs/kcal/recurrencerule.cpp	(révision 1122719)
+++ kdepimlibs/kcal/recurrencerule.cpp	(révision 1122720)
@@ -1727,7 +1727,7 @@
   if ( d->mDuration >= 0 ) {
     KDateTime endRecur = endDt();
     if ( endRecur.isValid() ) {
-      if ( start >= endRecur ) {
+      if ( start > endRecur ) {
         return result;    // beyond end of recurrence
       }
       if ( end > endRecur ) {
@@ -1757,7 +1757,7 @@
     if ( !d->mCached ) {
       d->buildCache();
     }
-    if ( d->mCachedDateEnd.isValid() && start >= d->mCachedDateEnd ) {
+    if ( d->mCachedDateEnd.isValid() && start > d->mCachedDateEnd ) {
       return result;    // beyond end of recurrence
     }
     int i = d->mCachedDates.findGE( start );
Index: kdepimlibs/kcal/icalformat_p.cpp
===================================================================
--- kdepimlibs/kcal/icalformat_p.cpp	(révision 1122719)
+++ kdepimlibs/kcal/icalformat_p.cpp	(révision 1122720)
@@ -784,7 +784,11 @@
   if ( att->isUri() ) {
     attach = icalattach_new_from_url( att->uri().toUtf8().data() );
   } else {
+#if ( LIBICAL_MAJOR_VERSION == 0 ) && ( LIBICAL_MINOR_VERSION < 45 )
     attach = icalattach_new_from_data ( ( unsigned char * )att->data(), 0, 0 );
+#else
+    attach = icalattach_new_from_data ( att->data(), 0, 0 );
+#endif
   }
   icalproperty *p = icalproperty_new_attach( attach );
 
Index: kdepimlibs/kcal/CMakeLists.txt
===================================================================
--- kdepimlibs/kcal/CMakeLists.txt	(révision 1122719)
+++ kdepimlibs/kcal/CMakeLists.txt	(révision 1122720)
@@ -3,6 +3,8 @@
 set(LIBICAL_MIN_VERSION "0.42")
 find_package(Libical)
 macro_log_feature(LIBICAL_FOUND "libical" "Reference implementation of the iCalendar data type and serialization format" "http://sourceforge.net/projects/freeassociation" TRUE "${LIBICAL_MIN_VERSION}" "Required for the critical PIM kcal library.")
+add_definitions(-DLIBICAL_MAJOR_VERSION=${LIBICAL_MAJOR_VERSION}
+                -DLIBICAL_MINOR_VERSION=${LIBICAL_MINOR_VERSION})
 
 add_definitions(-DKDE_DEFAULT_DEBUG_AREA=5800)
 
