diff -Nur kdegraphics-4.5.0/okular/generators/plucker/unpluck/image.cpp kdegraphics-4.5.0.me/okular/generators/plucker/unpluck/image.cpp
--- kdegraphics-4.5.0/okular/generators/plucker/unpluck/image.cpp	2008-02-21 10:27:47.000000000 +0100
+++ kdegraphics-4.5.0.me/okular/generators/plucker/unpluck/image.cpp	2010-08-25 22:03:11.000000000 +0200
@@ -289,8 +289,23 @@
             for (j = 0; j < bytes_per_row;) {
                 incount = *palm_ptr++;
                 inval = *palm_ptr++;
-                memset (rowbuf + j, inval, incount);
-                j += incount;
+                if (incount + j <= bytes_per_row  * width)
+                {
+                    memset (rowbuf + j, inval, incount);
+                    j += incount;
+                }
+                else
+                {
+                    free (rowbuf);
+                    free (lastrow);
+                    free (jpeg_row);
+
+                    jpeg_destroy_compress (&cinfo);
+
+                    fclose( outfile );
+
+                    return false;
+                }
             }
         }
         else if ((flags & PALM_IS_COMPRESSED_FLAG)
