From 74208c27f8bbd03045ea74f9f9f136372ea08444 Mon Sep 17 00:00:00 2001
From: Calum Lind <calumlind+deluge@gmail.com>
Date: Wed, 5 Dec 2012 13:41:30 +0000
Subject: [PATCH 2/2] Fix #2227 : Torrent file contains sha1 and ed2k digest
 that needs encoding to hex

---
 deluge/ui/common.py | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/deluge/ui/common.py b/deluge/ui/common.py
index 08504be..59ae5fa 100644
--- a/deluge/ui/common.py
+++ b/deluge/ui/common.py
@@ -104,8 +104,11 @@ def __init__(self, filename, filetree=1):
                 else:
                     path = decode_string(os.path.join(prefix, decode_string(os.path.join(*f["path"]), self.encoding)), self.encoding)
                 f["index"] = index
+                if "sha1" in f and len(f["sha1"]) == 20:
+                        f["sha1"] = f["sha1"].encode('hex')
+                if "ed2k" in f and len(f["ed2k"]) == 16:
+                        f["ed2k"] = f["ed2k"].encode('hex')
                 paths[path] = f
-
                 dirname = os.path.dirname(path)
                 while dirname:
                     dirinfo = dirs.setdefault(dirname, {})
-- 
1.8.0.2

