From 62a1602d5ad11b00272ba39db88144a19b2904e7 Mon Sep 17 00:00:00 2001
From: Calum Lind <calumlind+deluge@gmail.com>
Date: Wed, 5 Dec 2012 18:10:53 +0000
Subject: [PATCH 2/4] Fix #2129 : Empty filename can be set in AddTorrent
 dialog

---
 deluge/ui/gtkui/addtorrentdialog.py | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/deluge/ui/gtkui/addtorrentdialog.py b/deluge/ui/gtkui/addtorrentdialog.py
index 3283cef..bc970ae 100644
--- a/deluge/ui/gtkui/addtorrentdialog.py
+++ b/deluge/ui/gtkui/addtorrentdialog.py
@@ -844,7 +844,7 @@ def get_file_path(self, row, path=""):
     def _on_filename_edited(self, renderer, path, new_text):
         index = self.files_treestore[path][3]
 
-        new_text = new_text.strip(os.path.sep)
+        new_text = new_text.strip(os.path.sep).strip()
 
         # Return if the text hasn't changed
         if new_text == self.files_treestore[path][1]:
@@ -862,6 +862,8 @@ def _on_filename_edited(self, renderer, path, new_text):
 
         if index > -1:
             # We're renaming a file! Yay! That's easy!
+            if not new_text:
+                return
             parent = self.files_treestore.iter_parent(itr)
             file_path = os.path.join(self.get_file_path(parent), new_text)
 
-- 
1.8.0.2

