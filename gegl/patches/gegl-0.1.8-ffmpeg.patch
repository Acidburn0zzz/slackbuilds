diff -up operations/workshop/external/ff-save.c.orig operations/workshop/external/ff-save.c
--- operations/workshop/external/ff-save.c.orig	2011-09-29 14:10:17.000000000 -0300
+++ operations/workshop/external/ff-save.c	2012-01-15 04:09:52.996120756 -0200
@@ -455,7 +455,7 @@ write_audio_frame (GeglChantO *op, AVFor
                                        p->audio_outbuf_size, p->samples);
 
       pkt.pts = c->coded_frame->pts;
-      pkt.flags |= PKT_FLAG_KEY;
+      pkt.flags |= AV_PKT_FLAG_KEY;
       pkt.stream_index = st->index;
       pkt.data = p->audio_outbuf;
 
@@ -496,7 +496,7 @@ add_video_stream (GeglChantO *op, AVForm
 
   c = st->codec;
   c->codec_id = codec_id;
-  c->codec_type = CODEC_TYPE_VIDEO;
+  c->codec_type = AVMEDIA_TYPE_VIDEO;
 
   /* put sample propeters */
   c->bit_rate = op->bitrate;
@@ -689,7 +689,7 @@ write_video_frame (GeglChantO *op,
       AVPacket  pkt;
       av_init_packet (&pkt);
 
-      pkt.flags |= PKT_FLAG_KEY;
+      pkt.flags |= AV_PKT_FLAG_KEY;
       pkt.stream_index = st->index;
       pkt.data = (uint8_t *) picture_ptr;
       pkt.size = sizeof (AVPicture);
@@ -712,7 +712,7 @@ write_video_frame (GeglChantO *op,
 
           pkt.pts = c->coded_frame->pts;
           if (c->coded_frame->key_frame)
-            pkt.flags |= PKT_FLAG_KEY;
+            pkt.flags |= AV_PKT_FLAG_KEY;
           pkt.stream_index = st->index;
           pkt.data = p->video_outbuf;
           pkt.size = out_size;
@@ -738,15 +738,15 @@ tfile (GeglChantO *self)
 {
   Priv *p = (Priv*)self->chant_data;
 
-  p->fmt = guess_format (NULL, self->path, NULL);
+  p->fmt = av_guess_format (NULL, self->path, NULL);
   if (!p->fmt)
     {
       fprintf (stderr,
                "ff_save couldn't deduce outputformat from file extension: using MPEG.\n%s",
                "");
-      p->fmt = guess_format ("mpeg", NULL, NULL);
+      p->fmt = av_guess_format ("mpeg", NULL, NULL);
     }
-  p->oc = av_alloc_format_context ();/*g_malloc (sizeof (AVFormatContext));*/
+  p->oc = avformat_alloc_context ();/*g_malloc (sizeof (AVFormatContext));*/
   if (!p->oc)
     {
       fprintf (stderr, "memory error\n%s", "");
