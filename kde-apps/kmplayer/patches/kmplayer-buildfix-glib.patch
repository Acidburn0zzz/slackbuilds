diff -rupN kmplayer-0.11.3a.old/CMakeLists.txt kmplayer-0.11.3a/CMakeLists.txt
--- kmplayer-0.11.3a.old/CMakeLists.txt	2011-10-22 09:37:10.000000000 -0400
+++ kmplayer-0.11.3a/CMakeLists.txt	2011-12-26 01:56:13.133176874 -0500
@@ -34,6 +34,7 @@ if(NOT WIN32)
 
   if (KMPLAYER_BUILT_WITH_NPP)
     PKGCONFIG(dbus-glib-1 GLibDBusIncDir GLibDBusLinkDir GLibDBusLinkFlags GLibDBusCflags)
+    PKGCONFIG(gmodule-2.0 GModuleIncDir GModuleLinkDir GModuleLinkFlags GModuleCflags)
 
     if (GLibDBusCflags)
       set(KMPLAYER_WITH_GDBUS 1)
diff -rupN kmplayer-0.11.3a.old/src/CMakeLists.txt kmplayer-0.11.3a/src/CMakeLists.txt
--- kmplayer-0.11.3a.old/src/CMakeLists.txt	2011-10-22 09:37:10.000000000 -0400
+++ kmplayer-0.11.3a/src/CMakeLists.txt	2011-12-26 01:51:56.216361130 -0500
@@ -137,10 +137,10 @@ if (KMPLAYER_WITH_NPP)
     add_executable(knpplayer ${knpplayer_SRCS})
 
     SET_TARGET_PROPERTIES(knpplayer PROPERTIES COMPILE_FLAGS
-        "${GLibDBusCflags} ${GTKCflags} ${GThreadCflags}"
+        "${GLibDBusCflags} ${GTKCflags} ${GThreadCflags} ${GModuleCflags}"
     )
 
-    target_link_libraries(knpplayer ${GLibDBusLinkFlags} ${GTKLinkFlags} ${GThreadLinkFlags}
+    target_link_libraries(knpplayer ${GLibDBusLinkFlags} ${GTKLinkFlags} ${GThreadLinkFlags} ${GModuleLinkFlags}
         ${X11_X11_LIB} )
 
     install(TARGETS knpplayer ${INSTALL_TARGETS_DEFAULT_ARGS})
diff -rupN kmplayer-0.11.3a.old/src/npplayer.cpp kmplayer-0.11.3a/src/npplayer.cpp
--- kmplayer-0.11.3a.old/src/npplayer.cpp	2011-10-22 09:37:10.000000000 -0400
+++ kmplayer-0.11.3a/src/npplayer.cpp	2011-12-26 01:47:23.739606443 -0500
@@ -32,7 +32,7 @@ extern "C" {
 #include <fcntl.h>
 
 #include <glib/gprintf.h>
-#include <glib/gthread.h>
+#include <glib.h>
 #include <gdk/gdkx.h>
 #include <gtk/gtk.h>
 
