--- main.cpp	2011-01-20 22:24:01.000000000 +0800
+++ ../../kmozillahelper/main.cpp	2011-10-10 18:45:22.959139112 +0800
@@ -338,7 +338,24 @@
             {
             outputLine( QString::number( dialog.filterWidget()->currentIndex()));
             foreach( const KUrl& str, result )
-                outputLine( str.toLocalFile());
+            {
+                KIO::UDSEntry uds;
+                if ( KIO::StatJob* job = KIO::stat( str, KIO::HideProgressInfo ) ) {
+                    // we do not want to wait for the event loop to delete the job
+                    QScopedPointer<KIO::StatJob> sp( job );
+                    job->setAutoDelete( false );
+                    if ( KIO::NetAccess::synchronousRun( job, 0 ) ) {
+                        uds = job->statResult();
+                    }
+                }
+                if (uds.contains(KIO::UDSEntry::UDS_LOCAL_PATH))
+                {
+                    KUrl newUrl(uds.stringValue(KIO::UDSEntry::UDS_LOCAL_PATH));
+                    outputLine( newUrl.toLocalFile());
+                }
+                else
+                    outputLine( str.toLocalFile());
+            }
             return true;
             }
         }
