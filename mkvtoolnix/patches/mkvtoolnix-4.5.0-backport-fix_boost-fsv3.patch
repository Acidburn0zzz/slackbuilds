From 597e307cc1461c32eac5229556a75a1ebbb80cca Mon Sep 17 00:00:00 2001
From: Moritz Bunkus <moritz@bunkus.org>
Date: Tue, 15 Feb 2011 16:55:39 +0100
Subject: [PATCH] Fixed compilation with Boost's filesystem library v3; also require Boost 1.36.0 or newer

---
 ChangeLog                       |    4 ++++
 ac/boost.m4                     |    2 +-
 src/common/mm_multi_file_io.cpp |   14 +++++++++-----
 3 files changed, 14 insertions(+), 6 deletions(-)

diff --git a/ac/boost.m4 b/ac/boost.m4
index 86f75fa..a494247 100644
--- a/ac/boost.m4
+++ b/ac/boost.m4
@@ -1,5 +1,5 @@
 # boost's headers must be present.
-AX_BOOST_BASE([1.34.0])
+AX_BOOST_BASE([1.36.0])
 
 # boost::system can be absend for older versions. However, the test
 # for boost::filesystem might fail if boost::system is not available
diff --git a/src/common/mm_multi_file_io.cpp b/src/common/mm_multi_file_io.cpp
index 4418a9f..1157d91 100644
--- a/src/common/mm_multi_file_io.cpp
+++ b/src/common/mm_multi_file_io.cpp
@@ -15,6 +15,7 @@
 
 #include <algorithm>
 #include <boost/regex.hpp>
+#include <sstream>
 #include <vector>
 
 #include "common/mm_multi_file_io.h"
@@ -155,14 +156,17 @@ mm_multi_file_io_c::create_verbose_identification_info(std::vector<std::string>
 
 void
 mm_multi_file_io_c::display_other_file_info() {
-  std::vector<std::string> file_names;
+  std::stringstream out;
 
   foreach(const mm_multi_file_io_c::file_t &file, m_files)
-    if (file.m_file_name != m_files.front().m_file_name)
-      file_names.push_back(file.m_file_name.leaf());
+    if (file.m_file_name != m_files.front().m_file_name) {
+      if (!out.str().empty())
+        out << ", ";
+      out << file.m_file_name.filename();
+    }
 
-  if (!file_names.empty())
-    mxinfo(boost::format(Y("'%1%': Processing the following files as well: %2%\n")) % m_display_file_name % join(", ", file_names));
+  if (!out.str().empty())
+    mxinfo(boost::format(Y("'%1%': Processing the following files as well: %2%\n")) % m_display_file_name % out.str());
 }
 
 struct path_sorter_t {
-- 
1.7.0.4

